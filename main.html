<!DOCTYPE html>
<html>
  <head>
    <title>Eshterely.com: Your Shopping Zone!</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="eshterely.css">
    <link rel="stylesheet" href="css/font-awesome.css">
  </head>
  <body class="container">
    <div id="getheader">

    </div>

    <!-- MAIN CONTENT CONTAINER -->
    <content class="row">
      <!-- Catgeories menu left panel -->
      <div class="col-md-1">
        <!-- <h4>Categories</h4> -->
        <div class="list-group">
          <a href="#" class="list-group-item active"> Books</a>
          <a href="#" class="list-group-item"> Music</a>
          <a href="#" class="list-group-item"> Movies</a>
          <a href="#" class="list-group-item"> Games</a>
        </div>
      </div>

      <!-- Categories content -->
      <div class="col-md-11">
      <!-- Row 1 BOOKS -->
      <div class="row">
        <h3>Books</h3>
        <div id="bookslist">
        <!-- This section will be filled dynamically by the script with list of books in products.js -->
        </div>
      </div>
      <!-- Row 2 MUSIC-->
      <div class="row">
        <h3>Music</h3>
        <div id="musiclist">
        <!-- This section will be filled dynamically by the script with list of music albums in products.js -->
        </div>
      </div>
      <!-- Row 3 GAMES-->
      <div class="row">
        <h3>Games</h3>
        <div id="gameslist">
        <!-- This section will be filled dynamically by the script with list of games in products.js -->
        </div>
      </div>
    </content>



  <!-- footer -->
    <!-- <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"> -->

    <div id="getfooter"></div>


    <!-- jQuery for drop down in Nav bar to work (categories)-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.1.js"></script>
    <script src="my-html-loader.js"></script>
    <script src="products.js"></script>
    <script src="underscore.js"></script>
    <script>
      loader("navheader.html","#getheader")
      loader("ourfooter.html","#getfooter")
    </script>
    <script>
      // This function takes a product object and displays it in chosen html tag location
      var display_a_prod = function(singleProduct, htmltag){

        if(Array.isArray(singleProduct)){
          for(i=0;i<myObj.length;i++)
            display_a_prod(singleProduct[i]); // recursion because why not :D!
        }

        else{
          for(key in singleProduct){
            if(key === "id"){
              $(htmltag).append('<div id="'+singleProduct[key]+'" class="panel panel-success col-md-4 book">');
            }
            else if(key === "picture_url"){
              $(htmltag).append("<div>"+'<img style="max-width:150px" src="'+singleProduct[key]+'"/></div>');
            }
            else {
              $(htmltag).append('<div class="panel-heading name">'+singleProduct[key]+'</div>');
            }
          }
        }
      }

      var displayProd = function(prods, htmltag, categ){
        //Return only the same category as passed to this function 'categ'
        var prod = _.filter(prods, function(checkprod){
          if(checkprod.category===categ) return checkprod;
        });
        console.log(prod);
        var panelHeadStyle = "panel-default";
        if(categ==="books")
          panelHeadStyle = "panel-success";
        else if(categ==="music")
          panelHeadStyle = "panel-info";
        else if(categ==="games")
          panelHeadStyle = "panel-warning";

        for(var i=0;i<prod.length;i++)
        {
          var myString = "";
          myString += '<div id="'+prod[i].id+'" class="panel '+panelHeadStyle+' col-md-4">';
          myString += '  <div class="panel-heading name '+categ+'">'+prod[i].name+'</div>';
          myString += '  <div class="panel-body">';
          myString += '    <div class="row">';
          myString += '      <div class="col-md-6">';
          myString += '        <a href="details.html"><img class="content-img" src="'+prod[i].picture_url+'" alt="" /></a>';
          myString += '      </div>';
          myString += '      <div class="col-md-6">'
          myString += '        <div class="desc small">'+prod[i].description+'</div>';
          myString += '      </div>';
          myString += '    </div>';
          myString += '  </div>';
          myString += '  <div class="panel-footer container-fluid">';
          myString += '    <div class="col-md-3">';
          myString += '      <div class="category">'+prod[i].category+'</div>';
          myString += '    </div>';
          myString += '    <div class="col-md-3">';
          myString += '      <div class="price">'+prod[i].price+'</div>';
          myString += '    </div>';
          myString += '    <div class="col-md-3">';
          myString += '      <a role="button" class="btn btn-primary btn-xs" href="cart.html">Add to cart</a>';
          myString += '    </div>';
          myString += '    <div class="col-md-3">';
          myString += '      <a class="btn btn-success btn-xs" href="details.html">Read more</a>';
          myString += '    </div>';
          myString += '  </div>';
          myString += '</div>';

          $(htmltag).append(myString);
        }
      }
      displayProd(products, '#bookslist', 'books');
      displayProd(products, '#musiclist', 'music');
      displayProd(products, '#gameslist', 'games');
    </script>

  </body>
</html>
